input = "Hepyt-riap,_,po-teg,epyt-lobmys,enifed,esle,dna,etouq,po-fi,kcehc-ytira-erutaef##,tel,nigeb,niam,po-tsnoc,epyt-erudecorp,dnoc,po-llac/pmuj,po-tes,fi,epyt-gnirts,ro,kcilc:no@,ssalc@,adbmal,liat,!tes,rotceles-yreuq,fer-gnirts,edon-lmth-morf$,evitcaer/sjbir,wen-r,gnirts>-rebmun,redner,di-yb-tnemele,>elyts<,elipmoc,>1h<,poon-neg,nerdlihc&srtta-tilps,rebmun>-gnirts,tneitouq,>nottub<,fer-tsil,redner/sjbir,rtta-teg,!tes-1dleif,retteg-r,raac,pmc-gnirts,>vid<,rettes-r,ngissa-neg,txet-tes,xua-gnirtsbus,xua-rebmun>-gnirts,gnirts>-,xua-pmc-gnirts,?tnemele-lmth,edon-lmth-ot,?naeloob,rdddac,2xua-rebmun>-gnirts,foepyt$,ton,>p<,liat-tsil,tnemele-etaerc,llac-pmoc,2tsil,tsil>-gnirts,?ecnatsni,3tsil,nerdlihc-dda,xua-gnirts>-rebmun,hcae-rof,1tsil,dnetxe,erudecorp-ekam,?regetni,*,dnib-pmoc,txet-teg,?lobmys,?bir,dneppa,tneve-dda,gnirts>-tsil,?llun,?gnirts,rddac,0dleif,pukool,tnenopmoc,htgnel,llac-neg,+,gnirts>-lobmys,edon-dneppa,1dleif,fi-dliub,2dleif,htgnel-gnirts,nigeb-pmoc,lave,rtta-tes,<,-,srtta-tes,sgra-bn-dda,?=gnirts,esolc,gnirtsbus,rddc,2gra,1gra,rdac,?vqe,rac,?riap,rdc,pmoc,snoc,di,,,,bir;8S%liS9!S9GmGmGmZBqZJniT(Jl7.lYBmlX.k{wS0Z3niT-eiT0Z3liSFZOliSHiSLwS/ZAl_ZEl^YS'luFmWmYS#liSNYS+liT4FmYS(kFmZHk!:7$kZPl^{]P9&mi&:n`kk@niS-_i&{!S-Lm:nkw'kl]''l_(mZ'maAl_Cl^~Bl^}'!F'l^8FnYBmlbAl`^'l`~Dm_Cl_~Bl_})]05mYCma_5mYCmaYBm`l~i$5mYCma_5mYCmaYBm`l~iS<~Z%l_cYFnka_AlbCla)nZ0ofdAlb?mai$Cl`^~Bl_}+]N#n`kn8=l^~i$#n`kn8=l^~i$#n`kn8=l^~i$#n`kn8=l^~YNlTl^~Dmw/Vl^~DmkYGl^~YNl^{]@#nZNla_l}'!C#na_k#nk_k~DmiS-_}'!;)nb)nLm:nRngAlecw/km~BlAlaCl`^})]#)nRnLm:nh.w0km)nRnf~DmiS-fd?maaa^}-]((mi&^{]/(mZ(l`^}'],(mZ/mb`^})!>(mZ,nca_wS3})!)#nb`n9#pf?mi&?mbwSDawSD`90o?mfbYDl`_`~YOl_Al`)nci$)ncUn?mHldwS6?mAlElcwS:ClEla)nc?mAlElbwS:~DmClElbwS@~BlAla_~DmwS6^)nci$)ncGm^)ncGmZ,nUn?mHlgwS1wSDwSDZ(lZ/m`wSDwS;~BlHlbEla~BlAla_~DmwS1^)nci%)ncGm^)ncGmUni$?mHldwS?^~BlHlbEla~BlAla_~DmwS?^9#pfHldEl`Cl_`ClEl`~DmwS;^8;ncAla_~DmwS:^#nLmYCmfw3l#nd~YJlbZ&mi&:nRniS-HleZ'm?m?mfi$i$akZ$mYDl`mnEl`~DmwS.^)n:n@ngZ7lec@nfYHldboEla_~DmwS3^)nZ@mdYFnlbElbYHla_~GmDmwSA_9#pf?mi&?mbwSDawSD`90o?mfbYDl`_`~YOl_Al`)nci$)ncUn?mHldwS6?mAlElcwS:ClEla)nc?mAlElbwS:~DmClElbwS@~BlAla_~DmwS6^)nci$)ncGm^)ncGmZ,nUn?mHlgwS1wSDwSDZ(lZ/m`wSDwS;~BlHlbEla~BlAla_~DmwS1^)nci%)ncGm^)ncGmUni$?mHldwS?^~BlHlbEla~BlAla_~DmwS?^9#pfHldEl`Cl_`ClEl`~DmwS;^8;ncAla_~DmwS:^#nLmYCmfw3l#nd~YJlbZ&mi&:nRniS-HleZ'm?m?mfi$i$akZ$mYDl`mnEl`~DmwS.^)n:n@ngZ7lec@nfYHldboEla_~DmwS3^)nZ@mdYFnlbElbYHla_~Gm^~^DmwS,^#ncElan~DmwS>^Cl_~Bl_#nbYFnk``m~YOl_})!5'l_#na_n~iS<}'!S=o!S8n!SCm!S4l!S5k])'li$9)mAl`^FmX%lCl_~Bl_}']&#nl`^}']>8Kla9>o?mfYS*mbb`a_Nml`~Oma_}+!29>oi&b`^})];'lk'liT/~Bl_'ll9;mAlbAl`'ll~Om`^'liT/~Om__Cl`Cl^~Bl_~Bl^}']C9;mZ.l`Z.l^}'!4-mkZCm`^}'!S*9Im`YGl^}'!<i?].iG!K#nnYDl_^{!IZ-ln]6'l_'li$'li$96mNmNmvR%`Z$mbuAl_~OmvR/^~Om_vR$Cl^~Bl^}']=96mk^'li$~YJl^{]L'li$87m_k~^Z=l^9=lAl^~DmvPCl^'li$~YJl^Z.l^{]*'l^9*m_`~Omak?mb^YBmNmZ$mu``vR%ZKmu^}'!S&8KlZ*mi&^8Kl?mZ*mi&Nm`kvP~Omk^{]%94lYNl^{FmZFmki#!Ai?!OZ-lm]2'l^92mNml`Al^~Om`k}']I,lZ2m`^}'!M'l_(mYMmaAl_Cl^~Bl^}'!D'lk8BmYDlAl_l~Bl^{!J-mi&^{]D8GlYGl^{]78HlVl^{!H.lVl^{!18?lVl^{!.8GlVl^{!*i?!,iG!(#nk`^}'!+Z-lk]894l_'l^~^Dmi%^{]4-mi$^{]-3l'li$-mbTl^~YNl^{{!S2n!SBm!S7l!SEk]::nlkl!@:nlkm]9:nlkn]1:nlko!L:nlkp]?:nlkq!9:nlkr!P:nlks]G:nlkt!S$:nlku!S+:nlkv.]H'lk!S%Jl8@m_YS$liT,{y!S('li&]AJl3l'li&FmPnZ5l`iT'aFmZ?mZ<l_a{{]EJl3l8S)l`y{!S'Jl'l^FmPnZ5laiT$^FmPnkiSP^FmZ?mZ<l`^Z1liSK{y]<'liT88Kl^~Bl^'liT5'liT1~^~Z8l^8S&l^~Z%l^'l^~YIl^{!S)'liSG8:lYPl_~KmiSI^4miT+YPl_~KmiT2^9LlYPl_~KmiT%^8Pl_~KmiT)^ZGmiT;^{]5'liT<'liT6~Bl^'liT9~Z8l^'liSO~Z%l^'liSJ~YIl^{]M7%l`Gm^[$Jl(m_b7,l_[,YMm?m?mi&bInSlal_fYAl`Hl`El_Cl^~i$(m_b7,l_[,YMm?m?mi&bInSlal_fYAl`Hl`El_Cl^~i$(m_b7,l_[,YMm?m?mi&bInSlal_fYAl`Hl`El_Cl^~KmiT&InlkYAlCl^~YOlCl^~Bl^{i$[$i&i${!S#8Em_iT#z]O8Em_iT.z]J8Em_iT*z]38Em_iT7z]B8Em_iT3z!E'l^Fmi$'l^FmGmGmGmZ+m_aFmMm`aAl_Cl^ZMl`~Bl`Z1l^}']+'li$8@m`^~Z:l_9)m`Jl9+m_a{~Bl_8@mZ9l`^~GmYIl`'li$8@m`^~Z:l_9)m`Jl9+m_a{~Bl_8@mZ9l`^~Gm^~^Z%l_}'!6'li$6m`bFmPnb_b6m`bFmYLnQlbInSlan_b~KmiSMInnk^YAl`6m`bFmPnb_b6m`bFmYLnQlbInSlan_b~KmiSMInnk^`~YIl`HlaEl`Cl_6m`bFmPnQlb_b6m`bFmYLnQlbInSlan_b~KmiT:Innk^YAl`6m`bFmPnQlb_b6m`bFmYLnQlbInSlan_b~KmiT:Innk^`~YIl`AlaAlCl`ZDl_~BlCl_~Bl_}'!S<i%!T(:nnv.:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nki&vR&vCvNvCvS9vS,vS;vS5vS<vS6vR8!T-:nnl:nki&vR#!T0:nnv?:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nki&vCvS;vS(vCvS@vS3vS;vS5vS,vS9vS9vS<vS*vCvS:vS0vCvS9vS,vS;vS5vS<vS6vS*vCvS,vS/vRI!SF:nnvR=:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nki&vR#vS,vS4vS,vS/vS*vRHvCvS5vS0vCvCvCvCvCvCvCvCvCvCvCvCvCvCvCvCuvS5vS,vS;vS;vS0vS9vS>vCvS7vS7vS(vCvS)vS,vS>vCvS(vCvS-vS6vCvS,vS3vS7vS4vS(vS?vS,vCvS,vS3vS7vS4vS0vS:vCvS(vCvS:vS0vCvS:vS0vS/vRI!SH:nnv0:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nki&vDvS+vS3vS9vS6vRLvCvOvS6vS3vS3vS,vR=!SL:nno:nk:nk:nk:nki&vS5vS0vS(vS4!SN:nnvTN:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nki&vSDvCvCvCvCuvR0vS9vS,vS;vS5vS,vS*vCvR/vS;vS5vS,vS;vS5vS6vS*vPvS@vS-vS0vS;vS:vS<vS1vCvCvCvCvCvCvCvCuvR0vS9vS,vS;vS5vS,vS*vCvR/vS:vS4vS,vS;vS0vPvS5vS.vS0vS3vS(vCvCvCvCvCvCvCvCuvR0vS5vS4vS<vS3vS6vS*vCvR/vS5vS6vS0vS;vS*vS,vS9vS0vS+vPvS?vS,vS3vS-vCvCvCvCvCvCvCvCuvR0vS?vS,vS3vS-vCvR/vS@vS(vS3vS7vS:vS0vS+vCvCvCvCvCvCvCvCuvR0vS-vS0vS9vS,vS:vPvS:vS5vS(vS:vCvOvS(vS*vS0vS;vS,vS=vS3vS,vR=vCvOvS3vS(vS0vS9vR6vCvR/vS@vS3vS0vS4vS(vS-vPvS;vS5vS6vS-vCvCvCvCvCvCvCvCuvSBvCvS5vS0vS(vS4vR#!T4:nno:nk:nk:nk:nki&vS+vS(vS,vS/!T/Nmlk!T,:nnn:nk:nk:nki&vS7vS7vS(!T':nnq:nk:nk:nk:nk:nk:nki&vS,vS7vS@vS;vPvS9!T$:nnq:nk:nk:nk:nk:nk:nki&vS,vS7vS@vS;vPvS9!SP:nno:nk:nk:nk:nki&vS+vS0vPvS9!SK:nno:nk:nk:nk:nki&vS5vS(vS7vS:!T8:nno:nk:nk:nk:nki&vS3vS3vS<vS5!T5:nnp:nk:nk:nk:nk:nki&vS,vS:vS3vS(vS-!T1:nno:nk:nk:nk:nki&vS,vS<vS9vS;!SG:nno:nk:nk:nk:nki&vS3vS3vS<vS5!SI:nnp:nk:nk:nk:nk:nki&vS@vS(vS9vS9vS(!T+:nno:nk:nk:nk:nki&vS,vS<vS9vS;!T2:nnr:nk:nk:nk:nk:nk:nk:nki&vS5vS(vS,vS3vS6vS6vS)!T%:nnq:nk:nk:nk:nk:nk:nki&vS9vS,vS)vS4vS<vS5!T):nnq:nk:nk:nk:nk:nk:nki&vS.vS5vS0vS9vS;vS:!T;:nnq:nk:nk:nk:nk:nk:nki&vS,vS7vS@vS;vPvS9!T<:nno:nk:nk:nk:nki&vS3vS3vS<vS5!T6:nnp:nk:nk:nk:nk:nki&vS@vS(vS9vS9vS(!T9:nnr:nk:nk:nk:nk:nk:nk:nki&vS5vS(vS,vS3vS6vS6vS)!SO:nnq:nk:nk:nk:nk:nk:nki&vS9vS,vS)vS4vS<vS5!SJ:nnq:nk:nk:nk:nk:nk:nki&vS.vS5vS0vS9vS;vS:!T&:nnl:nki&vR5!T#:nnp:nk:nk:nk:nk:nki&vS,vS3vS@vS;vS:!T.:nnm:nk:nki&vR&vS/!T*:nnq:nk:nk:nk:nk:nk:nki&vS5vS6vS;vS;vS<vS)!T7:nnl:nki&vS7!T3:nnn:nk:nk:nki&vS=vS0vS+!SM:nnn:nk:nk:nki&vR/vS5vS6!T::nnn:nk:nk:nki&vR/vS5vS6]::nlkl!@:nlkm]9:nlkn]1:nlko!L:nlkp]?:nlkq!9:nlkr!P:nlks]G:nlkt!S$:nlku!S+:nlkv.]K:nlkv/]$:nlkv0!7:nlkv1!B:nlkv2!8:nlkv3!-:nlkv4]F:nlkv5!=:nlkv6!?:nlkv7!G:nlkv8!N:nlkv9!3:nlkv:!0:nlkv;!/:nlkv<!':nlkv={"; // @@(replace "Hepyt-riap,_,po-teg,epyt-lobmys,enifed,esle,dna,etouq,po-fi,kcehc-ytira-erutaef##,tel,nigeb,niam,po-tsnoc,epyt-erudecorp,dnoc,po-llac/pmuj,po-tes,fi,epyt-gnirts,ro,kcilc:no@,ssalc@,adbmal,liat,!tes,rotceles-yreuq,fer-gnirts,edon-lmth-morf$,evitcaer/sjbir,wen-r,gnirts>-rebmun,redner,di-yb-tnemele,>elyts<,elipmoc,>1h<,poon-neg,nerdlihc&srtta-tilps,rebmun>-gnirts,tneitouq,>nottub<,fer-tsil,redner/sjbir,rtta-teg,!tes-1dleif,retteg-r,raac,pmc-gnirts,>vid<,rettes-r,ngissa-neg,txet-tes,xua-gnirtsbus,xua-rebmun>-gnirts,gnirts>-,xua-pmc-gnirts,?tnemele-lmth,edon-lmth-ot,?naeloob,rdddac,2xua-rebmun>-gnirts,foepyt$,ton,>p<,liat-tsil,tnemele-etaerc,llac-pmoc,2tsil,tsil>-gnirts,?ecnatsni,3tsil,nerdlihc-dda,xua-gnirts>-rebmun,hcae-rof,1tsil,dnetxe,erudecorp-ekam,?regetni,*,dnib-pmoc,txet-teg,?lobmys,?bir,dneppa,tneve-dda,gnirts>-tsil,?llun,?gnirts,rddac,0dleif,pukool,tnenopmoc,htgnel,llac-neg,+,gnirts>-lobmys,edon-dneppa,1dleif,fi-dliub,2dleif,htgnel-gnirts,nigeb-pmoc,lave,rtta-tes,<,-,srtta-tes,sgra-bn-dda,?=gnirts,esolc,gnirtsbus,rddc,2gra,1gra,rdac,?vqe,rac,?riap,rdc,pmoc,snoc,di,,,,bir;8S%liS9!S9GmGmGmZBqZJniT(Jl7.lYBmlX.k{wS0Z3niT-eiT0Z3liSFZOliSHiSLwS/ZAl_ZEl^YS'luFmWmYS#liSNYS+liT4FmYS(kFmZHk!:7$kZPl^{]P9&mi&:n`kk@niS-_i&{!S-Lm:nkw'kl]''l_(mZ'maAl_Cl^~Bl^}'!F'l^8FnYBmlbAl`^'l`~Dm_Cl_~Bl_})]05mYCma_5mYCmaYBm`l~i$5mYCma_5mYCmaYBm`l~iS<~Z%l_cYFnka_AlbCla)nZ0ofdAlb?mai$Cl`^~Bl_}+]N#n`kn8=l^~i$#n`kn8=l^~i$#n`kn8=l^~i$#n`kn8=l^~YNlTl^~Dmw/Vl^~DmkYGl^~YNl^{]@#nZNla_l}'!C#na_k#nk_k~DmiS-_}'!;)nb)nLm:nRngAlecw/km~BlAlaCl`^})]#)nRnLm:nh.w0km)nRnf~DmiS-fd?maaa^}-]((mi&^{]/(mZ(l`^}'],(mZ/mb`^})!>(mZ,nca_wS3})!)#nb`n9#pf?mi&?mbwSDawSD`90o?mfbYDl`_`~YOl_Al`)nci$)ncUn?mHldwS6?mAlElcwS:ClEla)nc?mAlElbwS:~DmClElbwS@~BlAla_~DmwS6^)nci$)ncGm^)ncGmZ,nUn?mHlgwS1wSDwSDZ(lZ/m`wSDwS;~BlHlbEla~BlAla_~DmwS1^)nci%)ncGm^)ncGmUni$?mHldwS?^~BlHlbEla~BlAla_~DmwS?^9#pfHldEl`Cl_`ClEl`~DmwS;^8;ncAla_~DmwS:^#nLmYCmfw3l#nd~YJlbZ&mi&:nRniS-HleZ'm?m?mfi$i$akZ$mYDl`mnEl`~DmwS.^)n:n@ngZ7lec@nfYHldboEla_~DmwS3^)nZ@mdYFnlbElbYHla_~GmDmwSA_9#pf?mi&?mbwSDawSD`90o?mfbYDl`_`~YOl_Al`)nci$)ncUn?mHldwS6?mAlElcwS:ClEla)nc?mAlElbwS:~DmClElbwS@~BlAla_~DmwS6^)nci$)ncGm^)ncGmZ,nUn?mHlgwS1wSDwSDZ(lZ/m`wSDwS;~BlHlbEla~BlAla_~DmwS1^)nci%)ncGm^)ncGmUni$?mHldwS?^~BlHlbEla~BlAla_~DmwS?^9#pfHldEl`Cl_`ClEl`~DmwS;^8;ncAla_~DmwS:^#nLmYCmfw3l#nd~YJlbZ&mi&:nRniS-HleZ'm?m?mfi$i$akZ$mYDl`mnEl`~DmwS.^)n:n@ngZ7lec@nfYHldboEla_~DmwS3^)nZ@mdYFnlbElbYHla_~Gm^~^DmwS,^#ncElan~DmwS>^Cl_~Bl_#nbYFnk``m~YOl_})!5'l_#na_n~iS<}'!S=o!S8n!SCm!S4l!S5k])'li$9)mAl`^FmX%lCl_~Bl_}']&#nl`^}']>8Kla9>o?mfYS*mbb`a_Nml`~Oma_}+!29>oi&b`^})];'lk'liT/~Bl_'ll9;mAlbAl`'ll~Om`^'liT/~Om__Cl`Cl^~Bl_~Bl^}']C9;mZ.l`Z.l^}'!4-mkZCm`^}'!S*9Im`YGl^}'!<i?].iG!K#nnYDl_^{!IZ-ln]6'l_'li$'li$96mNmNmvR%`Z$mbuAl_~OmvR/^~Om_vR$Cl^~Bl^}']=96mk^'li$~YJl^{]L'li$87m_k~^Z=l^9=lAl^~DmvPCl^'li$~YJl^Z.l^{]*'l^9*m_`~Omak?mb^YBmNmZ$mu``vR%ZKmu^}'!S&8KlZ*mi&^8Kl?mZ*mi&Nm`kvP~Omk^{]%94lYNl^{FmZFmki#!Ai?!OZ-lm]2'l^92mNml`Al^~Om`k}']I,lZ2m`^}'!M'l_(mYMmaAl_Cl^~Bl^}'!D'lk8BmYDlAl_l~Bl^{!J-mi&^{]D8GlYGl^{]78HlVl^{!H.lVl^{!18?lVl^{!.8GlVl^{!*i?!,iG!(#nk`^}'!+Z-lk]894l_'l^~^Dmi%^{]4-mi$^{]-3l'li$-mbTl^~YNl^{{!S2n!SBm!S7l!SEk]::nlkl!@:nlkm]9:nlkn]1:nlko!L:nlkp]?:nlkq!9:nlkr!P:nlks]G:nlkt!S$:nlku!S+:nlkv.]H'lk!S%Jl8@m_YS$liT,{y!S('li&]AJl3l'li&FmPnZ5l`iT'aFmZ?mZ<l_a{{]EJl3l8S)l`y{!S'Jl'l^FmPnZ5laiT$^FmPnkiSP^FmZ?mZ<l`^Z1liSK{y]<'liT88Kl^~Bl^'liT5'liT1~^~Z8l^8S&l^~Z%l^'l^~YIl^{!S)'liSG8:lYPl_~KmiSI^4miT+YPl_~KmiT2^9LlYPl_~KmiT%^8Pl_~KmiT)^ZGmiT;^{]5'liT<'liT6~Bl^'liT9~Z8l^'liSO~Z%l^'liSJ~YIl^{]M7%l`Gm^[$Jl(m_b7,l_[,YMm?m?mi&bInSlal_fYAl`Hl`El_Cl^~i$(m_b7,l_[,YMm?m?mi&bInSlal_fYAl`Hl`El_Cl^~i$(m_b7,l_[,YMm?m?mi&bInSlal_fYAl`Hl`El_Cl^~KmiT&InlkYAlCl^~YOlCl^~Bl^{i$[$i&i${!S#8Em_iT#z]O8Em_iT.z]J8Em_iT*z]38Em_iT7z]B8Em_iT3z!E'l^Fmi$'l^FmGmGmGmZ+m_aFmMm`aAl_Cl^ZMl`~Bl`Z1l^}']+'li$8@m`^~Z:l_9)m`Jl9+m_a{~Bl_8@mZ9l`^~GmYIl`'li$8@m`^~Z:l_9)m`Jl9+m_a{~Bl_8@mZ9l`^~Gm^~^Z%l_}'!6'li$6m`bFmPnb_b6m`bFmYLnQlbInSlan_b~KmiSMInnk^YAl`6m`bFmPnb_b6m`bFmYLnQlbInSlan_b~KmiSMInnk^`~YIl`HlaEl`Cl_6m`bFmPnQlb_b6m`bFmYLnQlbInSlan_b~KmiT:Innk^YAl`6m`bFmPnQlb_b6m`bFmYLnQlbInSlan_b~KmiT:Innk^`~YIl`AlaAlCl`ZDl_~BlCl_~Bl_}'!S<i%!T(:nnv.:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nki&vR&vCvNvCvS9vS,vS;vS5vS<vS6vR8!T-:nnl:nki&vR#!T0:nnv?:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nki&vCvS;vS(vCvS@vS3vS;vS5vS,vS9vS9vS<vS*vCvS:vS0vCvS9vS,vS;vS5vS<vS6vS*vCvS,vS/vRI!SF:nnvR=:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nki&vR#vS,vS4vS,vS/vS*vRHvCvS5vS0vCvCvCvCvCvCvCvCvCvCvCvCvCvCvCvCuvS5vS,vS;vS;vS0vS9vS>vCvS7vS7vS(vCvS)vS,vS>vCvS(vCvS-vS6vCvS,vS3vS7vS4vS(vS?vS,vCvS,vS3vS7vS4vS0vS:vCvS(vCvS:vS0vCvS:vS0vS/vRI!SH:nnv0:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nki&vDvS+vS3vS9vS6vRLvCvOvS6vS3vS3vS,vR=!SL:nno:nk:nk:nk:nki&vS5vS0vS(vS4!SN:nnvTN:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nk:nki&vSDvCvCvCvCuvR0vS9vS,vS;vS5vS,vS*vCvR/vS;vS5vS,vS;vS5vS6vS*vPvS@vS-vS0vS;vS:vS<vS1vCvCvCvCvCvCvCvCuvR0vS9vS,vS;vS5vS,vS*vCvR/vS:vS4vS,vS;vS0vPvS5vS.vS0vS3vS(vCvCvCvCvCvCvCvCuvR0vS5vS4vS<vS3vS6vS*vCvR/vS5vS6vS0vS;vS*vS,vS9vS0vS+vPvS?vS,vS3vS-vCvCvCvCvCvCvCvCuvR0vS?vS,vS3vS-vCvR/vS@vS(vS3vS7vS:vS0vS+vCvCvCvCvCvCvCvCuvR0vS-vS0vS9vS,vS:vPvS:vS5vS(vS:vCvOvS(vS*vS0vS;vS,vS=vS3vS,vR=vCvOvS3vS(vS0vS9vR6vCvR/vS@vS3vS0vS4vS(vS-vPvS;vS5vS6vS-vCvCvCvCvCvCvCvCuvSBvCvS5vS0vS(vS4vR#!T4:nno:nk:nk:nk:nki&vS+vS(vS,vS/!T/Nmlk!T,:nnn:nk:nk:nki&vS7vS7vS(!T':nnq:nk:nk:nk:nk:nk:nki&vS,vS7vS@vS;vPvS9!T$:nnq:nk:nk:nk:nk:nk:nki&vS,vS7vS@vS;vPvS9!SP:nno:nk:nk:nk:nki&vS+vS0vPvS9!SK:nno:nk:nk:nk:nki&vS5vS(vS7vS:!T8:nno:nk:nk:nk:nki&vS3vS3vS<vS5!T5:nnp:nk:nk:nk:nk:nki&vS,vS:vS3vS(vS-!T1:nno:nk:nk:nk:nki&vS,vS<vS9vS;!SG:nno:nk:nk:nk:nki&vS3vS3vS<vS5!SI:nnp:nk:nk:nk:nk:nki&vS@vS(vS9vS9vS(!T+:nno:nk:nk:nk:nki&vS,vS<vS9vS;!T2:nnr:nk:nk:nk:nk:nk:nk:nki&vS5vS(vS,vS3vS6vS6vS)!T%:nnq:nk:nk:nk:nk:nk:nki&vS9vS,vS)vS4vS<vS5!T):nnq:nk:nk:nk:nk:nk:nki&vS.vS5vS0vS9vS;vS:!T;:nnq:nk:nk:nk:nk:nk:nki&vS,vS7vS@vS;vPvS9!T<:nno:nk:nk:nk:nki&vS3vS3vS<vS5!T6:nnp:nk:nk:nk:nk:nki&vS@vS(vS9vS9vS(!T9:nnr:nk:nk:nk:nk:nk:nk:nki&vS5vS(vS,vS3vS6vS6vS)!SO:nnq:nk:nk:nk:nk:nk:nki&vS9vS,vS)vS4vS<vS5!SJ:nnq:nk:nk:nk:nk:nk:nki&vS.vS5vS0vS9vS;vS:!T&:nnl:nki&vR5!T#:nnp:nk:nk:nk:nk:nki&vS,vS3vS@vS;vS:!T.:nnm:nk:nki&vR&vS/!T*:nnq:nk:nk:nk:nk:nk:nki&vS5vS6vS;vS;vS<vS)!T7:nnl:nki&vS7!T3:nnn:nk:nk:nki&vS=vS0vS+!SM:nnn:nk:nk:nki&vR/vS5vS6!T::nnn:nk:nk:nki&vR/vS5vS6]::nlkl!@:nlkm]9:nlkn]1:nlko!L:nlkp]?:nlkq!9:nlkr!P:nlks]G:nlkt!S$:nlku!S+:nlkv.]K:nlkv/]$:nlkv0!7:nlkv1!B:nlkv2!8:nlkv3!-:nlkv4]F:nlkv5!=:nlkv6!?:nlkv7!G:nlkv8!N:nlkv9!3:nlkv:!0:nlkv;!/:nlkv<!':nlkv={" (encode 92))@@



debug = false;
// )@@




lengthAttr = "length";

nodejs = ((function () { return this !== this.window; })()); //node
if (nodejs) { // in nodejs? //node

  // Implement putchar/getchar to the terminal //node

  node_fs = require("fs"); //node

  putchar = (c) => { //node
    let buffer = Buffer.alloc(1); //node
    buffer[0] = c; //node
    node_fs.writeSync(1, buffer, 0, 1); //node
    return c; //node
  }; //node

  getchar_sync = () => { //node
    let buffer = Buffer.alloc(1); //node
    if (node_fs.readSync(0, buffer, 0, 1)) //node
      return buffer[0]; //node
    return -1; //node
  }; //node

  getchar = () => { //node
    push(pos<input[lengthAttr] ? get_byte() : getchar_sync()); //node
    return true; // indicate that no further waiting is necessary //node
  }; //node

  sym2str = (s) => chars2str(s[1][0]); //node //debug
  chars2str = (s) => (s===NIL) ? "" : (String.fromCharCode(s[0])+chars2str(s[1])); //node //debug
  show_opnd = (o) => is_rib(o) ? ("sym " + sym2str(o)) : ("int " + o); //node //debug
  show_stack = () => { //node //debug
    let s = stack; //node //debug
    let r = []; //node //debug
    while (!s[2]) { r[r[lengthAttr]]=s[0]; s=s[1]; } //node //debug
    console.log(require("util").inspect(r, {showHidden: false, depth: 2}).replace(/\n/g, "").replace(/  /g, " ")); //node //debug
  } //node //debug

} else { // in web browser //node

  // Implement a simple console as a textarea in the web page

  domdoc = document;
  selstart = 0;
  addEventListenerAttr = "addEventListener";
  selectionStartAttr = "selectionStart";

  domdoc[addEventListenerAttr]("DOMContentLoaded", () => {
    run();
  });

  putchar = (c) => (selstart=txtarea[selectionStartAttr]=(txtarea.value += String.fromCharCode(c))[lengthAttr], c);

  getchar = () => pos<input[lengthAttr] && push(get_byte());
  show_stack = () => {console.log(stack)};
  sym2str = (s) => chars2str(s[1][0]); //node //debug
  chars2str = (s) => (s===NIL) ? "" : (String.fromCharCode(s[0])+chars2str(s[1])); //node //debug
  show_opnd = (o) => is_rib(o) ? "sym " + sym2str(o) : "int " + o; //node //debug
} //node

// VM

// build the symbol table

pos = 0;
get_byte = () => input[pos++].charCodeAt(0);
get_code = () => { let x = get_byte()-35; return x<0 ? 57 : x; };
get_int = (n) => { let x = get_code(); n *= 46; return x<46 ? n+x : get_int(n+x-46); };

pop = () => { let x = stack[0]; stack = stack[1]; return x; };

FALSE = [0,0,5]; TRUE = [0,0,5]; NIL = [0,0,5];

symtbl = NIL;
n = get_int(0);
while (n-- > 0) symtbl=[[0,[NIL,0,3],2],symtbl,0]; // symbols with empty names

accum = NIL;
n = 0;
while (1) {
  c = get_byte();
  if (c == 44) { symtbl=[[0,[accum,n,3],2],symtbl,0]; accum = NIL; n = 0; continue; }
  if (c == 59) break;
  accum = [c,accum,0];
  n++;
}

symtbl = [[0,[accum,n,3],2],symtbl,0];

symbol_ref = (n) => list_tail(symtbl,n)[0];
list_tail = (x,i) => i ? list_tail(x[1],i-1) : x;

// decode the instruction graph

stack = 0;

while (1) {
  x = get_code();
  n = x;
  d = 0;
  op = -1;
  while ((d=[20,30,0,10,11,4][++op])+2<n) n -= d+3;
  if (x>90)
    n = pop();
  else {
    if (!op) stack = [0,stack,0];
    n = n>=d ? (n==d ? get_int(0) : symbol_ref(get_int(n-d-1))) : op<3 ? symbol_ref(n) : n;
    if (4<op) {
      n = [[n,0,pop()],0,1];
      if (!stack) break;
      op=4;
    }
  }
  stack[0] = [op?op-1:0,n,stack[0]];
}

set_global = (x) => { symtbl[0][0] = x; symtbl = symtbl[1]; };

set_global([0,symtbl,1]); // primitive 0
set_global(FALSE);
set_global(TRUE);
set_global(NIL);

// RVM core

pc = n[0][2];
stack = [0,0,[5,0,0]]; // primordial continuation (executes halt instr.)

push = (x) => ((stack = [x,stack,0]), true);
bool2scm = (x) => x ? TRUE : FALSE;
// )@@
str2scm = (s) => {
    let l = s.length
    let i = l
    let a = NIL
    while (i) a=[s.charCodeAt(--i),a,0];
    return [a,l,3]
}
// )@@

find_sym = (name, symtbl) => {
  lst = scm2list(symtbl)
  return list_tail(symtbl, lst.indexOf(name))[0]

}
// )@@

function2scm = (f) => {
  let host_call = find_sym('host-call', symtbl)
  let id = find_sym('id', symtbl)
  let arg2 = find_sym('arg2', symtbl)
  let rib = [[0, 0, 1], [NIL, 0, 3], 2]
  if (host_call == -1 || id == -1){
    console.log("ERROR : you must define host-call as a primitive to convert a function to a rib")
    return
  }

  let code = [3, foreign(f),  // push(foreign(f))
              [2, 1, // inverse arguments
               [0, host_call,  // call host_call primitive
                [0, arg2, // discard argument on stack
                 [0, id, 0]]]]] // return
  let i = f.length // number of args
  while(i--){
    code = [3, 0,  // push 0
             [0, rib, // call rib
              code]]
  }
  code = [f.length, 0,     // number of params
          [3, NIL, code]] // push nil

  let env = 0 // no environment
  return [code, env, 1] // return the procedure
}
// )@@

host2scm = (v) => {
  return ({"number":(x)=>x,"boolean":bool2scm,"string":str2scm,"object":obj2scm, 'function':function2scm, 'undefined':()=>NIL}[typeof v](v))
}
// )@@

obj2scm = (o) => Array.isArray(o) ? list2scm(o) : foreign(o)
// )@@

list2scm = (l,i=0) => (i<l.length?[host2scm(l[i]),list2scm(l,i+1),0]:NIL)
// )@@

scm2str = (r) => {
    let f = (c) => (c===NIL?"":String.fromCharCode(c[0])+f(c[1]))
    return f(r[0])
}
// )@@

scm2bool = (r) => {
  if (r === NIL){
    return []
  }
  if (r === FALSE){
    return false
  }
  if (r === TRUE){
    return true
  }
  console.error("Cannot convert ", r, " to bool");
}
// )@@

scm2list = (r) => {
  let elems = r[2] === 0 ? r : r[0];
  let lst = [];
  let f = (c) => {
    if (c !== NIL){
      lst.push(scm2host(c[0]))
      f(c[1])
    }
  }
  f(elems)
  return lst
}
// )@@

func_stack = []
scm2function = (r) => {
  let func = (...args) => {
    func_stack.push(pc)
    push(r)
    for(let a of args){
      push(host2scm(a))
    }
    // push(args.length)
    // )@@
    pc = [0,args.length,[5, 0, 0]] // call function and then halt
    run()
    pc = func_stack.pop()
    return_value = pop()
    console.log(return_value)
    return scm2host(return_value)
  }
  return func
}
// )@@


scm2symbol = (r) => {
  return scm2str(r[1])
}
// )@@


scm2host = (r) => {
  if (typeof r === "number")
    return r 
  let tag = r[2]
  return [scm2list, scm2function, scm2symbol, scm2str, scm2list, scm2bool, (x) => x[1]][tag](r);
}
 // )@@


foreign = (r) => [0, r, 6] // 6 is to tag a foreign object
// )@@


is_rib = (x) => x[lengthAttr];

get_opnd = (o) => is_rib(o) ? o : list_tail(stack,o);
get_cont = () => { let s = stack; while (!s[2]) s = s[1]; return s; };

prim1 = (f) => () => push(f(pop()));
prim2 = (f) => () => push(f(pop(),pop()));
prim3 = (f) => () => push(f(pop(),pop(),pop()));

primitives = [
  prim3((z, y, x) => [x, y, z]),                    //  @@(primitive (rib a b c))@@
prim1((e) => bool2scm(Array.isArray(e) && e[1] instanceof HTMLElement)),prim2((element, parent) => parent[1].append(scm2host(element))),() => push(foreign(document.createTextNode(scm2host(pop())))),prim1((tag) => foreign(document.createElement(scm2str(tag)))),prim3((value, name, e) => {e[1].addEventListener(scm2str(name), eval(scm2host(value))); return true;}),prim2((value, e) => host2scm((e[1].innerText = `${scm2host(value)}`))),prim3((value, name, e) => host2scm((e[1].setAttribute(scm2str(name), scm2host(value))))),prim1((e) => str2scm(e[1].innerText)),prim2((attr, e) => host2scm(e[1].getAttribute(scm2str(attr)))),() => push(foreign(document.getElementById(scm2str(pop())))),() => push(foreign(document.querySelector(scm2str(pop())))),  prim2((y, x) => x/y|0),                           //  @@(primitive (quotient x y))@@
  prim2((y, x) => x*y),                             //  @@(primitive (* x y))@@
  prim2((y, x) => x-y),                             //  @@(primitive (- x y))@@
  prim2((y, x) => x+y),                             //  @@(primitive (+ x y))@@
  prim2((y, x) => bool2scm(x<y)),                //  @@(primitive (< x y) (use bool2scm))@@
  prim2((y, x) => bool2scm(x===y)),              //  @@(primitive (eqv? x y) (use bool2scm))@@
  prim2((y, x) => x[1]=y),                          //  @@(primitive (field1-set! rib))@@
  prim1((x) => x[2]),                               //  @@(primitive (field2 rib))@@
  prim1((x) => x[1]),                               //  @@(primitive (field1 rib))@@
  prim1((x) => x[0]),                               //  @@(primitive (field0 rib))@@
  prim1((x) => bool2scm(is_rib(x))),             //  @@(primitive (rib? rib) (use bool2scm))@@
  () => push([pop()[0],stack,1]),                   //  @@(primitive (close rib))@@
  () => { let y = pop(); pop(); return push(y); },  //  @@(primitive (arg2 x y))@@
  () => (pop(), true),                              //  @@(primitive (arg1 x y))@@
  prim1((x) => x),                                  //  @@(primitive (id x))@@
];

run = () => {
  while (1) {
    let o = pc[1];
    switch (pc[0]) {
    case 5: // halt
        return;
    case 0: // jump/call
        if (debug) { console.log((pc[2]===0 ? "--- jump " : "--- call ") + show_opnd(o)); show_stack(); } //debug

        // if (is_rib(n_passed_args)) push(n_passed_args);
        if (show_opnd(o) === "sym console.log") {
          //  pop();
        }

        o = get_opnd(o)[0];
        let nargs=pop();
        // )@@
        let c = o[0];

        if (is_rib(c)) {
            let c2 = [0,o,0];
            let s2 = c2;

            
            let nparams = c[0] >> 1; 
            if (c[0] & 1 ? nparams > nargs : nparams != nargs){
                console.log("*** Unexpected number of arguments nargs:", nargs, " nparams:", nparams, "variadics:", c[0]&1);
                halt();
            }
            // )@@

            nargs-=nparams;
            if (c[0]&1) {
                let rest=NIL;
                while(nargs--) 
                    rest=[pop(), rest, 0];
                s2=[rest,s2,0]
            }
            // )@@
            while (nparams--) s2 = [pop(),s2,0];

            if (pc[2] === 0) {
                // jump
                let k = get_cont();
                c2[0] = k[0];
                c2[2] = k[2];
            } else {
                // call
                c2[0] = stack;
                c2[2] = pc[2];
            }
            stack = s2;
        } else {
            if (!primitives[c]()) return;
            if (pc[2] === 0) {
                // jump
                c = get_cont();
                stack[1] = c[0];
            } else {
                // call
                c = pc;
            }
        }
        pc = c;
        break;
    case 1: // set
        if (debug) { console.log("--- set " + show_opnd(o)); show_stack(); } //debug
        get_opnd(o)[0] = pop();
        break;
    case 2: // get
        if (debug) { console.log("--- get " + show_opnd(o)); show_stack(); } //debug
        push(get_opnd(o)[0]);
        break;
    case 3: // const
        if (debug) { console.log("--- const " + (is_rib(o) ? "" : ("int " + o))); show_stack(); } //debug
        push(o);
        break;
    case 4: // if
        if (debug) { console.log("--- if"); show_stack(); } //debug
        if (pop() !== FALSE) { pc = pc[1]; continue; }
        break;
    }
      pc = pc[2];
  }
};

if (nodejs) run(); //node
